<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Events Calendar</title>

<style>
/* YOUR ORIGINAL STYLES REMAIN UNCHANGED */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 40px;
  background-color: #002147;
  color: #fff;
}

header {
  text-align: center;
  margin-bottom: 30px;
  position: relative;
}

.version {
  font-size: 0.8em;
  color: #aaa;
  font-style: italic;
  margin-bottom: 8px;
  display: block;
}

header img.logo-left {
  width: 120px;
  position: absolute;
  left: 0;
  top: 25px;
}
header img.logo-right {
  width: 120px;
  position: absolute;
  right: 0;
  top: 25px;
}
header img.logo-center {
  width: 160px;
  display: block;
  margin: 25px auto 15px auto;
}

header h1 { color: #FFD700; margin: 0; }
header h2 { color: #FFD700; margin: 0; }

table {
  width: 90%;
  margin: 0 auto;
  border-collapse: collapse;
  background-color: #1a1a1a;
}

th, td {
  border: 1px solid #333;
  padding: 14px;
}

th {
  background-color: #800000;
  color: #FFD700;
}

tr:nth-child(even) { background-color: #262626; }

.btn {
  display: inline-block;
  background-color: #FFD700;
  color: #000;
  font-weight: bold;
  padding: 12px 24px;
  border-radius: 6px;
  margin: 5px;
  cursor: pointer;
}

#requestPanel input {
  width: 300px;
  padding: 8px;
  margin: 6px;
}
</style>
</head>

<body>

<header>
<span class="version">Version 1.0PRI</span>
<img src="logo-left.png" class="logo-left">
<img src="logo-right.png" class="logo-right">
<img src="logo.png" class="logo-center">
<h1>Message Believer's Network Calendar</h1>
<h2>By The Distributor</h2>
</header>

<div style="text-align:center;">

<button class="btn" onclick="toggleRequest()">Request Event</button>
<a href="members.html" class="btn">Members</a>

<div id="requestPanel" style="display:none; margin-top:20px;">
<h3>Login To Request Event</h3>
<input id="reqUser" placeholder="Username">
<input id="reqPass" type="password" placeholder="Password"><br>
<button class="btn" onclick="loginForRequest()">Login</button>

<div id="eventForm" style="display:none; margin-top:20px;">

<input id="eventDate" type="date" placeholder="Date"><br>
<input id="eventTitle" placeholder="Event Name"><br>
<input id="eventDetails" placeholder="Details"><br>
<input id="eventHost" placeholder="Host Church"><br>
<input id="eventInvite" placeholder="Invitation Link"><br>

<button class="btn" onclick="submitEvent()">Submit Event</button>
</div>
</div>

</div>

<table id="eventsTable">
<tr>
<th>Date</th>
<th>Event</th>
<th>Details</th>
<th>Host Church</th>
<th>Invitation</th>
</tr>
</table>

<script>

/* STORAGE */
function getUsers(){ return JSON.parse(localStorage.getItem("users")||"{}"); }
function getApproved(){ return JSON.parse(localStorage.getItem("approvedEvents")||"[]"); }
function getPending(){ return JSON.parse(localStorage.getItem("pendingEvents")||"[]"); }
function savePending(p){ localStorage.setItem("pendingEvents",JSON.stringify(p)); }

let loggedUser=null;

function toggleRequest(){
  const panel=document.getElementById("requestPanel");
  panel.style.display = panel.style.display==="none"?"block":"none";
}

function loginForRequest(){
  const users=getUsers();
  const user=users[reqUser.value];

  if(user && user.password===reqPass.value && user.canRequestEvent && user.active){
    loggedUser=reqUser.value;
    document.getElementById("eventForm").style.display="block";
  } else {
    alert("No permission to request events.");
  }
}

function submitEvent(){
  const pending=getPending();

  pending.push({
    date:eventDate.value,
    title:eventTitle.value,
    details:eventDetails.value,
    host:eventHost.value,
    invite:eventInvite.value
  });

  savePending(pending);
  alert("Event submitted for approval.");

  eventDate.value="";
  eventTitle.value="";
  eventDetails.value="";
  eventHost.value="";
  eventInvite.value="";
}

function loadApproved(){
  const approved=getApproved();
  const table=document.getElementById("eventsTable");

  approved.forEach((e,index)=>{
    table.innerHTML+=`
    <tr>
      <td>${e.date}</td>
      <td>${e.title}</td>
      <td>${e.details}</td>
      <td>${e.host}</td>
      <td><a href="${e.invite}" target="_blank">View Invite</a></td>
    </tr>`;
  });
}

loadApproved();

</script>
</body>
</html>
