<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Members Portal</title>

<style>
body{
  font-family:Arial;
  background:#002147;
  color:#fff;
  padding:40px;
}
h2{color:#FFD700;}
input, select{
  width:100%;
  padding:8px;
  margin:6px 0;
}
button{
  padding:8px 14px;
  margin:5px 2px;
  cursor:pointer;
  border:none;
  border-radius:4px;
}
.btn{background:#FFD700;color:#000;font-weight:bold;}
.btn-danger{background:#800000;color:#fff;}
.box{
  background:#1a1a1a;
  padding:20px;
  margin:20px 0;
  border-radius:8px;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #333;
  padding:8px;
}
th{background:#800000;color:#FFD700;}
</style>
</head>
<body>

<h2>Members Login</h2>

<div id="loginStage" class="box">
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button class="btn" onclick="login()">Login</button>
</div>

<div id="membersStage" style="display:none;">

  <div class="box">
    <button class="btn" onclick="logout()">Logout</button>
  </div>

  <div id="adminControls" class="box" style="display:none;">
    <h3>Admin Controls</h3>

    <input type="text" id="newUsername" placeholder="Username">
    <input type="password" id="newPassword" placeholder="Password">
    <select id="newRole">
      <option value="member">Member</option>
      <option value="admin">Admin</option>
    </select>
    <input type="text" id="memberDetails" placeholder="Membership Details">

    <button class="btn" onclick="saveUser()">Save User</button>
    <button class="btn btn-danger" onclick="clearForm()">Clear</button>

    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Role</th>
          <th>Status</th>
          <th>Details</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="usersTable"></tbody>
    </table>
  </div>

</div>

<script>

/* STORAGE */
function getUsers(){ return JSON.parse(localStorage.getItem("users")||"{}"); }
function saveUsers(u){ localStorage.setItem("users",JSON.stringify(u)); }

/* INIT DEFAULT ADMINS */
if(!localStorage.getItem("users")){
  saveUsers({
    admin1:{password:"admin123",role:"admin",active:true,details:"Super Admin"},
    admin2:{password:"admin456",role:"admin",active:true,details:"Super Admin"}
  });
}

/* SESSION */
function setSession(user,role){
  localStorage.setItem("currentUser",user);
  localStorage.setItem("currentRole",role);
}
function clearSession(){
  localStorage.removeItem("currentUser");
  localStorage.removeItem("currentRole");
}

/* LOGIN */
function login(){
  const users=getUsers();
  const user=users[username.value];

  if(user && user.password===password.value && user.active){
    setSession(username.value,user.role);

    loginStage.style.display="none";
    membersStage.style.display="block";

    if(user.role==="admin"){
      adminControls.style.display="block";
      loadUsers();
    }
  } else {
    alert("Invalid or disabled account.");
  }
}

/* LOGOUT */
function logout(){
  clearSession();
  location.reload();
}

/* CLEAR FORM */
function clearForm(){
  newUsername.value="";
  newPassword.value="";
  newRole.value="member";
  memberDetails.value="";
}

/* SAVE OR UPDATE USER */
function saveUser(){
  const users=getUsers();

  if(!newUsername.value || !newPassword.value){
    alert("Username and Password required.");
    return;
  }

  users[newUsername.value]={
    password:newPassword.value,
    role:newRole.value,
    active:true,
    details:memberDetails.value
  };

  saveUsers(users);
  loadUsers();
  clearForm();
}

/* LOAD USERS TABLE */
function loadUsers(){
  const users=getUsers();
  usersTable.innerHTML="";

  Object.keys(users).forEach(username=>{
    const u=users[username];

    usersTable.innerHTML+=`
    <tr>
      <td>${username}</td>
      <td>${u.role}</td>
      <td>${u.active?"Active":"Disabled"}</td>
      <td>${u.details||""}</td>
      <td>
        <button class="btn" onclick="editUser('${username}')">Edit</button>
        <button class="btn" onclick="toggleUser('${username}')">${u.active?"Disable":"Enable"}</button>
        <button class="btn btn-danger" onclick="deleteUser('${username}')">Delete</button>
      </td>
    </tr>`;
  });
}

/* EDIT USER */
function editUser(username){
  const users=getUsers();
  const u=users[username];

  newUsername.value=username;
  newPassword.value=u.password;
  newRole.value=u.role;
  memberDetails.value=u.details||"";
}

/* ENABLE / DISABLE */
function toggleUser(username){
  const users=getUsers();
  users[username].active=!users[username].active;
  saveUsers(users);
  loadUsers();
}

/* DELETE USER */
function deleteUser(username){
  if(!confirm("Delete user permanently?")) return;

  const users=getUsers();
  delete users[username];
  saveUsers(users);
  loadUsers();
}

</script>

</body>
</html>
